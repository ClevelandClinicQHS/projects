---
title: "'projects' R package demonstration"
output: github_document
---

```{r include=FALSE}
knitr::opts_chunk$set(error = TRUE)
```

```{r change_home, include=FALSE, error=FALSE}
library(fs)
library(tidyverse)

temp_home_dir <- "/home/kriegen/Projects/projects/demonstration"

# fs::dir_tree() fixed so that it can handle tildes (~)
dir_tree2 <- function(path) {
  capture.output(
    path %>%
      path_expand_r() %>%
      dir_tree(all = TRUE)
  ) %>% 
    sub(temp_home_dir, "~", .) %>%
    cat(sep = "\n")
}

Sys.setenv(HOME = temp_home_dir)
Sys.unsetenv("PROJECTS_FOLDER_PATH")
# options(tibble.print_max = Inf, tibble.width = 76L)
```

The user can install the `projects` package from the Comprehensive R Archive Network (CRAN):

```{r install, eval=FALSE}
install.packages("projects")
```

The user then loads the package:

```{r attach, error=FALSE}
library(projects)
```

As the startup message indicates, the user must run `setup_projects()` in order to initialize the */projects/* folder. The function accepts the path of the directory wherein the user would like for the */projects/* folder to dwell. Here, the user establishes the */projects/* folder in the home directory:

```{r setup_projects}
setup_projects("~")
```

This mock *~/projects/* folder has now been created in the user's home directory, and it is also available for viewing in the [demonstration](https://github.com/NikKrieger/projects/tree/master/demonstration) folder on the `projects` GitHub.

The message suggests adding affiliations and authors before creating projects because it takes marginally more user effort to change an existing project's authorship than to specify authorship upon a project's creation.

```{r new_affiliations_authors, results='hide', message=FALSE}
new_affiliation(
  department_name  = "Department of Physics",
  institution_name = "University of North Science",
  address = "314 Newton Blvd, Springfield CT 06003"
)
new_affiliation(
  department_name  = "Impossibles Investigation Team",
  institution_name = "Creekshirebrook Academy of Thinks",
  address = "Let Gade 27182, 1566 Copenhagen, Denmark"
)
new_affiliation(
  department_name  = "Statistical Consulting Unit",
  institution_name = "Creekshirebrook Academy of Thinks",
  address = "196 Normal Ave, Columbus, OH ",
  id = 50
)
new_author(
  given_names = "Scott",
  last_name = "Bug",
  title = "Professor",
  affiliations = c(2, "Physics"),
  degree = "PhD",
  email = "scottbug@imPOSSible.net",
  phone = "965-555-5556"
)
new_author(
  given_names = "Marie",
  last_name = "Curie",
  title = "Chemist",
  affiliations = "Unit",
  phone = "553-867-5309",
  id = 86
)
new_author(
  given_names = "George Washington",
  last_name = "Carver",
  title = "Botanist",
  degree = "MS",
  affiliations = c(1, 2, 50),
  id = 1337
)
new_author(
  given_names = "Leonardo",
  last_name = "da Vinci",
  title = "Mathematician"
)
new_author(
  last_name = "Wu",
  given_names = "Chien-Shiung",
  title = "Physicist",
  affiliations = c("of North", "Statistical Consulting"),
  degree = "PhD",
  email = "wu@WU.wU"
)
## Output suppressed in knitted file for brevity
```

```{r view_affiliations_and_authors, comment=NA}
affiliations()
authors()
```

We will now create a project called "Creating Cold Fusion":

```{r new_project1, comment=NA}
new_project(
  title = "Achieving Cold Fusion",
  short_title = "ACF",
  authors = list("Bug", "Chien-Shiung", "Leonardo", 1337, 86),
  current_owner = "Carver",
  corresp_auth = "Bug",
  creator = "Curie",
  stage = "1: design",
  deadline_type = "Pilot study",
  deadline = "2020-12-31",
  use_bib = TRUE,
  id = 12
)
```

This creates the project folder at *~/projects/p0012/*. The */projects/* folder would be structured as follows:

```{r dir_tree_projects, echo=FALSE, comment=NA}
dir_tree2("~/projects")
```

The user may now begin work on this project. The [demonstration](https://github.com/NikKrieger/projects/tree/master/demonstration) folder on the `projects` GitHub contains this project folder, with a mock project completed in order to demonstrate workflow from 01_protocol.Rmd to 04_report.Rmd.
