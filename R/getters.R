################################################################################
################################################################################
#' @export
projects_folder <- function() {
  p_path_internal(error = FALSE)
}
################################################################################
################################################################################



################################################################################
################################################################################
p_path_internal <- function(error = TRUE) {
  
  path <- Sys.getenv("PROJECTS_FOLDER_PATH")
  
  if(fs::dir_exists(path)) {
    return(path)
  }
  else {
    notice <- '"projects" folder not found. Please run setup_projects_folder()'
    if(error) {
      stop(notice)
    }
    else {
      return(notice)
    }
  }
}
################################################################################
################################################################################



################################################################################
################################################################################
# User .rds-getting functions

#' @export
projects <- function() {
  "projects" %>% make_rds_path() %>% get_rds()
}

#' @export
authors <- function() {
  "authors" %>% make_rds_path() %>% get_rds()
}

#' @export
affiliations <- function() {
  "affiliations" %>% make_rds_path() %>% get_rds()
}